model Usuarios{
  idUsuario         Int @id @default(autoincrement())
  nombre            String 
  correo            String @unique
  password          String 
  tipoUsuario       Int
  telefono          String
  fechaCreacion     DateTime @default(now())
  fechaModificacion DateTime
  borrado           Int @default(0)

  propietarios      Propietarios[]
}

model Propietarios{
  idPropietario     Int @id @default(autoincrement())
  idUsuario         Int
  nombre            String 
  apaterno          String
  amaterno          String?
  correo            String
  telefono          String
  direccion         String
  rfc               String
  tipoPropietario   Int
  fechaCreacion     DateTime @default(now())
  fechaModificacion DateTime
  borrado           Int @default(0)
  
  propiedades       Propiedades[]
  
  usuario           Usuarios @relation(fields: [idUsuario], references: [idUsuario])
}

model Arrendatarios {
  idArrendatario    Int @id @default(autoincrement())
  idFoto            Int 
  nombre            String 
  email             String @unique
  telefono          String
  rfc               String
  direccion         String
  comentarios       String 
  fechaCreacion     DateTime @default(now())
  fechaModificacion DateTime
  borrado           Int @default(0)

  contrato          Contrato[]
  foto              Fotos @relation(fields: [idFoto], references: [idFoto])
}




model Propiedades {
  idPropiedad           Int @id @default(autoincrement())
  idPropietario         Int
  idFotoPropiedad       Int
  idFotoUbicacion       Int
  nombre                String 
  tipoPropiedad         Int
  descripcion           String
  ubicacion             String
  costo                 Float
  anticipioMinimo       Float 
  mesesMinimo           Int
  fechaCreacion         DateTime @default(now())
  fechaModificacion     DateTime
  borrado               Int @default(0)
  estado                Boolean @default(false)
  
  mantenimientos        Mantenimientos[]
  contrato              Contrato[]

  fotos                 Fotos @relation(fields: [idFotoPropiedad,idFotoUbicacion], references: [idFoto, idFoto])
  propietario           Propietarios @relation(fields: [idPropietario], references: [idPropietario])
}

model Fotos {
  idFoto                Int @id @default(autoincrement())
  url                   String
  fechaCreacion         DateTime @default(now())
  fechaModificacion     DateTime @updatedAt

  arrendatario          Arrendatarios[]
  propiedad             Propiedades[]
  contrato              Contrato[]
}



model Mantenimientos {
  idMantenimiento         Int @id @default(autoincrement())
  idPropiedad             Int
  tipoMantenimiento       Int 
  descripcion             String
  proveedor               String
  precio                  Float
  fechaMantenimiento      DateTime
  fechaCreacion           DateTime @default(now())
  fechaModificacion       DateTime
  borrado                 Int @default(0)
  //Mantenimiento no va relacionado con el contrato y cada uno va por cuenta del propietario

  propiedad               Propiedades @relation(fields: [idPropiedad], references: [idPropiedad])
}

model Contrato {
  idContrato            Int @id @default(autoincrement())
  idArrendatario        Int
  idPropietario         Int
  idPropiedad           Int
  contrato              String
  tipoContrato          Int
  fechaContrato         DateTime
  fechaInicio           DateTime
  fechaFin              DateTime
  deposito              Float
  duracion              Int
  fechaCreacion         DateTime @default(now())
  fechaModificacion     DateTime
  estado                Boolean @default(true)
  borrado               Int @default(0)

  pagos                 Pagos[]
  foto                  Fotos[]

  propiedad             Propiedades @relation(fields: [idPropiedad], references: [idPropiedad])
  arrendatario          Arrendatarios @relation(fields: [idArrendatario], references: [idArrendatario])
}

model Pagos {
  idPago                Int @id @default(autoincrement())
  idContrato            Int
  fechaVencimiento      DateTime
  fechaPago             DateTime
  pago                  Float
  numPago               Int  @unique
  mes                   Int @default(1)
  anio                  Int @default(0)
  fechaCracion          DateTime
  fechaModificacion     DateTime
  borrado               Int

  contrato              Contrato @relation(fields: [idContrato], references: [idContrato])
}

model Factura {
  idFactura Int @id @default(autoincrement())
  rfcPropietario String
  rfcArrendatario String
  ubicacion String
  numFolio String
  //selloDigitalSat 
}
